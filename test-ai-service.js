class TestAIService {
  constructor() {
    this.moodRecommendations = {
      '—ç–Ω–µ—Ä–≥–∏—è': {
        oils: ['–ú—è—Ç–∞ –ø–µ—Ä–µ—á–Ω–∞—è', '–†–æ–∑–º–∞—Ä–∏–Ω', '–õ–∏–º–æ–Ω'],
        description: '–î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ –∏ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏',
        advice: '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—Ç—Ä–æ–º –¥–ª—è –±–æ–¥—Ä–æ—Å—Ç–∏ –∏–ª–∏ –¥–Ω–µ–º –¥–ª—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏'
      },
      '—Å—Ç—Ä–µ—Å—Å': {
        oils: ['–õ–∞–≤–∞–Ω–¥–∞', '–†–æ–º–∞—à–∫–∞', '–ò–ª–∞–Ω–≥-–∏–ª–∞–Ω–≥'],
        description: '–î–ª—è —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏—è –∏ —Å–Ω—è—Ç–∏—è —Å—Ç—Ä–µ—Å—Å–∞',
        advice: '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ—á–µ—Ä–æ–º –¥–ª—è —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏'
      },
      '—Å–æ–Ω': {
        oils: ['–õ–∞–≤–∞–Ω–¥–∞', '–†–æ–º–∞—à–∫–∞', '–í–µ—Ç–∏–≤–µ—Ä'],
        description: '–î–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ —Å–Ω–∞',
        advice: '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞ —á–∞—Å –¥–æ —Å–Ω–∞ –¥–ª—è —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏—è'
      },
      '–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è': {
        oils: ['–†–æ–∑–º–∞—Ä–∏–Ω', '–ú—è—Ç–∞', '–õ–∏–º–æ–Ω'],
        description: '–î–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –∏ –ø–∞–º—è—Ç–∏',
        advice: '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∏–ª–∏ —É—á–µ–±—ã'
      }
    };

    this.musicRecommendations = {
      '—Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ': [
        'Brian Eno - "Music for Airports"',
        'Debussy - "Clair de Lune"',
        '–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–≤—É–∫–∏ –¥–æ–∂–¥—è'
      ],
      '—ç–Ω–µ—Ä–≥–∏—è': [
        'Tycho - "Dive"',
        'Classical music for focus',
        'Ambient electronic'
      ],
      '–º–µ–¥–∏—Ç–∞—Ü–∏—è': [
        'Tibetan singing bowls',
        'Forest sounds',
        'Ocean waves'
      ]
    };
  }

  async getMoodRecommendation(mood, oils, keywords = []) {
    try {
      // –ò–º–∏—Ç–∏—Ä—É–µ–º –∑–∞–¥–µ—Ä–∂–∫—É API
      await new Promise(resolve => setTimeout(resolve, 100));

      const normalizedMood = mood.toLowerCase();
      let recommendation = null;

      // –ò—â–µ–º –ø–æ–¥—Ö–æ–¥—è—â—É—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é
      for (const [key, value] of Object.entries(this.moodRecommendations)) {
        if (normalizedMood.includes(key)) {
          recommendation = value;
          break;
        }
      }

      if (!recommendation) {
        recommendation = this.moodRecommendations['—ç–Ω–µ—Ä–≥–∏—è']; // –¥–µ—Ñ–æ–ª—Ç–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
      }

      return `üåø **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è: "${mood}"**

${recommendation.description}

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–∞—Å–ª–∞:**
${recommendation.oils.map(oil => `‚Ä¢ ${oil}`).join('\n')}

**–°–æ–≤–µ—Ç –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é:**
${recommendation.advice}

**–ù–∞—É—á–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
–≠—Ñ–∏—Ä–Ω—ã–µ –º–∞—Å–ª–∞ –≤–æ–∑–¥–µ–π—Å—Ç–≤—É—é—Ç –Ω–∞ –ª–∏–º–±–∏—á–µ—Å–∫—É—é —Å–∏—Å—Ç–µ–º—É –º–æ–∑–≥–∞, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —ç–º–æ—Ü–∏–∏ –∏ –ø–∞–º—è—Ç—å. –ê—Ä–æ–º–∞—Ç–µ—Ä–∞–ø–∏—è –ø–æ–º–æ–≥–∞–µ—Ç —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ —Å–Ω–∏–∂–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–µ—Å—Å–∞.

**–ú–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏:**
‚Ä¢ –†–∞–∑–≤–µ–¥–∏—Ç–µ –º–∞—Å–ª–æ –≤ –±–∞–∑–æ–≤–æ–º –º–∞—Å–ª–µ –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º
‚Ä¢ –ü—Ä–æ–≤–µ–¥–∏—Ç–µ —Ç–µ—Å—Ç –Ω–∞ –∞–ª–ª–µ—Ä–≥–∏—é
‚Ä¢ –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏ –±–µ–∑ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –≤—Ä–∞—á–∞
‚Ä¢ –•—Ä–∞–Ω–∏—Ç–µ –≤ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ–º –¥–ª—è –¥–µ—Ç–µ–π –º–µ—Å—Ç–µ

üí° **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã:**
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∏—Ñ—Ñ—É–∑–æ—Ä –¥–ª—è –∞—Ä–æ–º–∞—Ç–µ—Ä–∞–ø–∏–∏
‚Ä¢ –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ –º–∞—Å—Å–∞–∂ —Å –º–∞—Å–ª–∞–º–∏
‚Ä¢ –°–æ–∑–¥–∞–π—Ç–µ —Ä–∞—Å—Å–ª–∞–±–ª—è—é—â—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É

üòä –ù–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –∞—Ä–æ–º–∞—Ç–µ—Ä–∞–ø–∏–µ–π!`;
    } catch (error) {
      console.error('Error getting mood recommendation:', error);
      return `üåø **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è: "${mood}"**

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Å–µ–π—á–∞—Å –Ω–µ –º–æ–≥—É –¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:

‚Ä¢ **–õ–∞–≤–∞–Ω–¥–∞** - –¥–ª—è —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏—è –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è
‚Ä¢ **–ú—è—Ç–∞** - –¥–ª—è —ç–Ω–µ—Ä–≥–∏–∏ –∏ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏  
‚Ä¢ **–õ–∏–º–æ–Ω** - –¥–ª—è –ø–æ–¥–Ω—è—Ç–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
‚Ä¢ **–≠–≤–∫–∞–ª–∏–ø—Ç** - –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏ —É–º–∞

üí° –ù–∞–ø–∏—à–∏—Ç–µ —Ç–æ—á–Ω–µ–µ, —á—Ç–æ –≤–∞—Å –±–µ—Å–ø–æ–∫–æ–∏—Ç, –∏ —è –¥–∞–º –±–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–æ–≤–µ—Ç—ã!`;
    }
  }

  async getMusicRecommendation(request) {
    try {
      // –ò–º–∏—Ç–∏—Ä—É–µ–º –∑–∞–¥–µ—Ä–∂–∫—É API
      await new Promise(resolve => setTimeout(resolve, 100));

      const text = request.originalText.toLowerCase();
      let category = '—Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ'; // –¥–µ—Ñ–æ–ª—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è

      if (text.includes('—ç–Ω–µ—Ä–≥–∏—è') || text.includes('–±–æ–¥—Ä–æ—Å—Ç—å')) {
        category = '—ç–Ω–µ—Ä–≥–∏—è';
      } else if (text.includes('–º–µ–¥–∏—Ç–∞—Ü–∏—è') || text.includes('—Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ')) {
        category = '–º–µ–¥–∏—Ç–∞—Ü–∏—è';
      }

      const recommendations = this.musicRecommendations[category];

      return `üéµ **–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

–í–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ç–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –¥–ª—è ${category}:

${recommendations.map(rec => `üéß ${rec}`).join('\n')}

**–ü–æ—á–µ–º—É —ç—Ç–∞ –º—É–∑—ã–∫–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç:**
‚Ä¢ –ü–æ–º–æ–≥–∞–µ—Ç —Å–æ–∑–¥–∞—Ç—å –Ω—É–∂–Ω—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É
‚Ä¢ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –∞—Ä–æ–º–∞—Ç–µ—Ä–∞–ø–∏–µ–π
‚Ä¢ –£–ª—É—á—à–∞–µ—Ç –æ–±—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç

**–°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:**
‚Ä¢ –í–∫–ª—é—á–∏—Ç–µ –º—É–∑—ã–∫—É –Ω–∞ —Ñ–æ–Ω–µ
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–º–µ—Å—Ç–µ —Å —ç—Ñ–∏—Ä–Ω—ã–º–∏ –º–∞—Å–ª–∞–º–∏
‚Ä¢ –°–æ–∑–¥–∞–π—Ç–µ —Ä–∞—Å—Å–ª–∞–±–ª—è—é—â—É—é –æ–±—Å—Ç–∞–Ω–æ–≤–∫—É

üí° –í–∫–ª—é—á–∏—Ç–µ –ª—é–±–∏–º—É—é –º—É–∑—ã–∫—É –∏ –Ω–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –∞—Ä–æ–º–∞—Ç–µ—Ä–∞–ø–∏–µ–π!`;
    } catch (error) {
      console.error('Error getting music recommendation:', error);
      return `üéµ **–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

–í–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ç–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏—è:

üéß **–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –º—É–∑—ã–∫–∞:**
‚Ä¢ Debussy - "Clair de Lune"
‚Ä¢ Chopin - "Nocturnes"

üéß **Ambient/–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞:**
‚Ä¢ Brian Eno - "Music for Airports"
‚Ä¢ Tycho - "Dive"

üéß **–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –∑–≤—É–∫–∏:**
‚Ä¢ –ó–≤—É–∫–∏ –¥–æ–∂–¥—è
‚Ä¢ –û–∫–µ–∞–Ω—Å–∫–∏–µ –≤–æ–ª–Ω—ã
‚Ä¢ –õ–µ—Å–Ω—ã–µ –ø—Ç–∏—Ü—ã

üí° –í–∫–ª—é—á–∏—Ç–µ –ª—é–±–∏–º—É—é –º—É–∑—ã–∫—É –∏ –Ω–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –∞—Ä–æ–º–∞—Ç–µ—Ä–∞–ø–∏–µ–π!`;
    }
  }
}

module.exports = TestAIService; 